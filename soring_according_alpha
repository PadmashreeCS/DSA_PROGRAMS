#include <stdio.h>
#include <stdlib.h>
#include <string.h> // REQUIRED for strcmp()

// Define the maximum length for student names
#define MAX_NAME_LEN 50 

// --- Structure Definition (Updated for strings) ---
struct node
{
    char name[MAX_NAME_LEN]; // Changed from int data
    struct node *next;
};

// Global variables removed (local definitions are used for safety)

// --- Function to Insert a Node at the End (Updated for strings) ---
void insertAtEnd(struct node **head) 
{
    struct node *newnode = (struct node *)malloc(sizeof(struct node));
    
    if (newnode == NULL) 
    {
        printf("Memory allocation failed!\n");
        return;
    }

    printf("Enter student name: ");
    // Use scanf and strncpy for string input
    scanf("%s", newnode->name); 
    newnode->next = NULL;

    if (*head == NULL) 
    {
        *head = newnode;
    } 
    else 
    {
        struct node *temp = *head;
        while (temp->next != NULL)
        {
            temp = temp->next;
        }
        temp->next = newnode;
    }
}

// --- Function to Display the List (Updated for strings) ---
void display(struct node* head)
{
    struct node* temp = head;
    while (temp != NULL)
    {
        // Print name instead of data
        printf("%s ", temp->name); 
        temp = temp->next;
    }
    printf("\n");
}

// --- Function to Merge Two Alphabetically Sorted Lists ---
struct node* merge(struct node* p, struct node* q)
{
    struct node *new_head = NULL;
    struct node *sorting = NULL;
    
    // Base cases
    if (p == NULL) return q;
    if (q == NULL) return p;

    // 1. Select the first node (Head of the new list)
    // Use strcmp() to compare names alphabetically
    if (strcmp(p->name, q->name) <= 0) 
    {
        new_head = sorting = p;
        p = p->next;
    }
    else
    {
        new_head = sorting = q;
        q = q->next;
    }

    // 2. Iterate and Merge using alphabetical comparison
    while (p != NULL && q != NULL) 
    {
        // Use strcmp() for the merging decision
        if (strcmp(p->name, q->name) <= 0)
        {
            sorting->next = p;
            sorting = p;
            p = p->next;
        }
        else
        {
            sorting->next = q;
            sorting = q;
            q = q->next;
        }
    }
    // 

    // 3. Attach remaining nodes
    if (p == NULL)
        sorting->next = q;
    else
        sorting->next = p;

    return new_head;
}

// --- Main Function ---
int main()
{
    struct node *head1 = NULL, *head2 = NULL, *merged = NULL;
    int n;

    printf("\n--- Insert List 1 (Enter names in sorted order) ---\n");
    printf("How many nodes in List 1? ");
    scanf("%d", &n);
    for(int i = 0; i < n; i++)
        insertAtEnd(&head1); 

    printf("\n--- Insert List 2 (Enter names in sorted order) ---\n");
    printf("How many nodes in List 2? ");
    scanf("%d", &n);
    for(int i = 0; i < n; i++)
        insertAtEnd(&head2);

    printf("\nList 1: ");
    display(head1);

    printf("List 2: ");
    display(head2);

    // Merge lists alphabetically
    merged = merge(head1, head2);

    printf("Merged List: ");
    display(merged);

    return 0;
}
